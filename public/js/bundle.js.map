{"mappings":"ACAA,kBAAkB,GAClB,gDAAgD;AAEzC,MAAM,4CAAa,CAAC;IACzB,SAAS,cACP;IACF,MAAM,MAAM,IAAI,SAAS,IAAI;QAC3B,WAAW;QACX,OAAO;QACP,YAAY;IACd;IAEA,MAAM,SAAS,IAAI,SAAS;IAE5B,UAAU,QAAQ,CAAC;QACjB,eAAe;QACf,MAAM,KAAK,SAAS,cAAc;QAClC,GAAG,YAAY;QAEf,kBAAkB;QAClB,IAAI,SAAS,OAAO;YAClB,SAAS;YACT,QAAQ;QACV,GACG,UAAU,IAAI,aACd,MAAM;QAET,YAAY;QACZ,IAAI,SAAS,MAAM;YAAE,QAAQ;QAAG,GAC7B,UAAU,IAAI,aACd,QAAQ,CAAC,OAAO,EAAE,IAAI,IAAI,EAAE,EAAE,IAAI,YAAY,IAAI,CAAC,EACnD,MAAM;QAET,iDAAiD;QACjD,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,UAAU,QAAQ;QACpB,SAAS;YACP,KAAK;YACL,QAAQ;YACR,MAAM;YACN,OAAO;QACT;IACF;AACF;;AD7CA,kBAAkB;AGAlB,2BAA2B;AAEpB,MAAM,4CAAY;IACvB,MAAM,KAAK,SAAS,cAAc;IAClC,IAAI,IAAI,GAAG,cAAc,YAAY;AACvC;AAGO,MAAM,4CAAY,CAAC,MAAM;IAC9B;IAEA,MAAM,SAAS,CAAC,yBAAyB,EAAE,KAAK,EAAE,EAAE,IAAI,MAAM,CAAC;IAC/D,SAAS,cAAc,QAAQ,mBAAmB,cAAc;IAEhE,OAAO,WAAW,2CAAW;AAC/B;;;ADbO,MAAM,4CAAQ,OAAO,OAAO;IACjC,IAAI;QACF,MAAM,MAAM,MAAM,MAAM;YACtB,QAAQ;YACR,KAAK;YACL,MAAM;uBACJ;0BACA;YACF;QACF;QAEA,IAAI,IAAI,KAAK,WAAW,WAAW;YACjC,CAAA,GAAA,yCAAQ,EAAE,WAAW;YACrB,OAAO,WAAW;gBAChB,SAAS,OAAO;YAClB,GAAG;QACL;IACF,EAAE,OAAO,KAAK;QACZ,CAAA,GAAA,yCAAQ,EAAE,SAAS,IAAI,SAAS,KAAK;IACvC;AACF;AAEO,MAAM,4CAAS;IACpB,IAAI;QACF,MAAM,MAAM,MAAM,MAAM;YACtB,QAAQ;YACR,KAAK;QACP;QAEA,IAAI,IAAI,KAAK,UAAU,WACrB,SAAS,OAAO;IAEpB,EAAE,OAAO,KAAK;QACZ,CAAA,GAAA,yCAAQ,EAAE,SAAS;IACrB;AACF;;;;AEjCO,MAAM,4CAAiB,OAAO,MAAM;IACzC,IAAI;QACF,QAAQ,IAAI;QACZ,MAAM,MACJ,SAAS,aACL,sDACA;QACN,MAAM,MAAM,MAAM,MAAM;iBACtB;YACA,QAAQ;kBACR;QACF;QAEA,IAAI,IAAI,KAAK,WAAW,WAAW;YACjC,QAAQ,IAAI,IAAI;YAChB,CAAA,GAAA,yCAAQ,EAAE,WAAW,CAAC,EAAE,KAAK,cAAc,sBAAsB,CAAC;QACpE;IACF,EAAE,OAAO,KAAK;QACZ,QAAQ,IAAI;QACZ,CAAA,GAAA,yCAAQ,EAAE,SAAS,IAAI,SAAS,KAAK;IACvC;AACF;;;;ACzBA,MAAM,+BAAS,OACb;AAIK,MAAM,4CAAW,OAAO;IAC7B,IAAI;QACF,mCAAmC;QACnC,MAAM,UAAU,MAAM,MAAM,KAC1B,CAAC,kCAAkC,EAAE,OAAO,CAAC;QAG/C,gDAAgD;QAEhD,MAAM,6BAAO,mBAAmB;YAC9B,WAAW,QAAQ,KAAK,QAAQ;QAClC;IACF,EAAE,OAAO,KAAK;QACZ,QAAQ,IAAI;QACZ,UAAU,SAAS;IACrB;AACF;;;ALfA,eAAe;AACf,MAAM,+BAAS,SAAS,eAAe;AACvC,MAAM,kCAAY,SAAS,cAAc;AACzC,MAAM,kCAAY,SAAS,cAAc;AACzC,MAAM,mCAAa,SAAS,cAAc;AAC1C,MAAM,2CAAqB,SAAS,cAAc;AAClD,MAAM,gCAAU,SAAS,eAAe;AAExC,aAAa;AACb,IAAI,8BAAQ;IACV,MAAM,YAAY,KAAK,MAAM,6BAAO,QAAQ;IAC5C,CAAA,GAAA,yCAAS,EAAE;AACb;AAEA,IAAI,iCACF,gCAAU,iBAAiB,UAAU,CAAC;IACpC,EAAE;IACF,MAAM,QAAQ,SAAS,eAAe,SAAS;IAC/C,MAAM,WAAW,SAAS,eAAe,YAAY;IAErD,CAAA,GAAA,yCAAI,EAAE,OAAO;AACf;AAGF,IAAI,iCACF,gCAAU,iBAAiB,SAAS,CAAA,GAAA,yCAAK;AAG3C,IAAI,kCACF,iCAAW,iBAAiB,UAAU,CAAC;IACrC,EAAE;IACF,MAAM,OAAO,IAAI;IACjB,KAAK,OAAO,QAAQ,SAAS,eAAe,QAAQ;IACpD,KAAK,OAAO,SAAS,SAAS,eAAe,SAAS;IACtD,KAAK,OAAO,SAAS,SAAS,eAAe,SAAS,KAAK,CAAC,EAAE;IAE9D,CAAA,GAAA,yCAAa,EAAE,MAAM;AACvB;AAGF,IAAI,0CAAoB;IACtB,QAAQ,IAAI;IACZ,yCAAmB,iBAAiB,UAAU,OAAO;QACnD,EAAE;QACF,SAAS,cAAc,uBAAuB,cAAc;QAC5D,MAAM,eAAe,SAAS,eAAe,oBAAoB;QACjE,MAAM,WAAW,SAAS,eAAe,YAAY;QACrD,MAAM,kBAAkB,SAAS,eAAe,oBAAoB;QACpE,MAAM,CAAA,GAAA,yCAAa,EACjB;sBAAE;6BAAU;0BAAiB;QAAa,GAC1C;QAGF,SAAS,eAAe,oBAAoB,QAAQ;QACpD,SAAS,eAAe,YAAY,QAAQ;QAC5C,SAAS,eAAe,oBAAoB,QAAQ;IACtD;AACF;AAEA,IAAI,+BACF,8BAAQ,iBAAiB,SAAS,CAAC;IACjC,EAAE,OAAO,cAAc;IACvB,MAAM,UAAE,MAAM,EAAE,GAAG,EAAE,OAAO;IAC5B,CAAA,GAAA,yCAAO,EAAE;AACX","sources":["public/js/index.js","public/js/mapbox.js","public/js/login.js","public/js/alert.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\nimport { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\n\n// DOM ELEMENTS\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst submitForm = document.querySelector('.form-user-data');\nconst submitFormPassword = document.querySelector('.form-user-password');\nconst bookBtn = document.getElementById('book-tour');\n\n// DELEGATION\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm) {\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n\n    login(email, password);\n  });\n}\n\nif (logOutBtn) {\n  logOutBtn.addEventListener('click', logout);\n}\n\nif (submitForm) {\n  submitForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n\n    updateSettings(form, 'data');\n  });\n}\n\nif (submitFormPassword) {\n  console.log(submitFormPassword);\n  submitFormPassword.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.bnt--save-password').textContent = 'Updating....';\n    const passwordPrev = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings(\n      { password, passwordConfirm, passwordPrev },\n      'password'\n    );\n\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n}\n\nif (bookBtn) {\n  bookBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n}\n","/* eslint-disable */\r\n// import * as maptilersdk from '@maptiler/sdk';\r\n\r\nexport const displayMap = (locations) => {\r\n  mapboxgl.accessToken =\r\n    'pk.eyJ1IjoidW1hbmcwNyIsImEiOiJjbGtsaHY2ZmIxYzJzM29yenA0bGE0dmxyIn0.25lXLxcIg50m8LsKyRmjaw';\r\n  const map = new mapboxgl.Map({\r\n    container: 'map', // container ID\r\n    style: 'mapbox://styles/umang07/clklluulb000301qx7h0iat25', // style URL\r\n    scrollZoom: false,\r\n  });\r\n\r\n  const bounds = new mapboxgl.LngLatBounds();\r\n\r\n  locations.forEach((loc) => {\r\n    // Add a morker\r\n    const el = document.createElement('div');\r\n    el.className = 'marker';\r\n\r\n    //   Create Marker\r\n    new mapboxgl.Marker({\r\n      element: el,\r\n      anchor: 'bottom',\r\n    })\r\n      .setLngLat(loc.coordinates)\r\n      .addTo(map);\r\n\r\n    // Add popup\r\n    new mapboxgl.Popup({ offset: 30 })\r\n      .setLngLat(loc.coordinates)\r\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\r\n      .addTo(map);\r\n\r\n    // Extends map bounds to include current location\r\n    bounds.extend(loc.coordinates);\r\n  });\r\n\r\n  map.fitBounds(bounds, {\r\n    padding: {\r\n      top: 200,\r\n      bottom: 200,\r\n      left: 100,\r\n      right: 100,\r\n    },\r\n  });\r\n};\r\n","import { showAlert } from './alert';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: 'http://localhost:3000/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: 'http://localhost:3000/api/v1/users/logout',\r\n    });\r\n\r\n    if (res.data.status == 'success') {\r\n      location.reload(true);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', 'Error logging out! Try Again');\r\n  }\r\n};\r\n","// type is success or error\r\n\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n/* eslint-disable */\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n","import { showAlert } from './alert';\r\n\r\n// updateData\r\n// type is either password or data\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    console.log(data);\r\n    const url =\r\n      type === 'password'\r\n        ? 'http://localhost:3000/api/v1/users/updatePassword'\r\n        : 'http://localhost:3000/api/v1/users/updateMe';\r\n    const res = await axios({\r\n      url,\r\n      method: 'PATCH',\r\n      data,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      console.log(res.data);\r\n      showAlert('success', `${type.toUpperCase()} Updated Successfully'`);\r\n    }\r\n  } catch (err) {\r\n    console.log(err);\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","const stripe = Stripe(\r\n  'pk_test_51NH531SBYp4Ve4TSrSn1M2EXtgIGufhgFtrXPOhR6GCZBru5kll1nxxPAjTlZjufDga45BweGmC343D2XcMU1pzj009zT4gZaU'\r\n);\r\nimport { showAlerts } from './alert';\r\n\r\nexport const bookTour = async (tourId) => {\r\n  try {\r\n    // 1) Get Checkout session from API\r\n    const session = await axios.post(\r\n      `/api/v1/bookings/checkout-session/${tourId}`\r\n    );\r\n\r\n    // 2) Create Checkout form + charge credit card\\\r\n\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (err) {\r\n    console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"bundle.js.map","sourceRoot":"../../"}